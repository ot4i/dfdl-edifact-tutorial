<!DOCTYPE html>
<html class="no-js" lang="en">
 
	
<!-- header::Start -->
	<head>
		<!-- Use Internet Explorer 9 Standards mode for Eclipse Browser Control - https://www.eclipse.org/swt/faq.php#browsernativeie and https://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx -->
  		<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
		
		<!-- Next 2 http=equiv headers required to disable caching the Eclipse Browser Widget -->
		<meta http-equiv="Pragma" content="no-cache">
  		<meta http-equiv="Expires" content="-1">

		<meta charset="UTF-8"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<meta name="copyright" content="Copyright IBM Corporation 2014" />
		<meta name="abstract" content="IBM Integration Bus V10 Tutorial">
		<meta name="author" content="IBM">
		<meta name="description" content="IBM Integration Bus V10 Tutorial">
		<meta name="keywords" content="keywords" > 
		<meta name="robots" content="index,follow">
		<meta name="source" content="IBM Integration Bus V10 Tutorial" /> 
		
		<title>IBM Integration Bus V10 Tutorial</title>

    	<link rel="stylesheet" href="http://ot4i.github.io/ot4i.tutorials/dist/css/main.css" />
		<link rel="stylesheet" href="http://ot4i.github.io/ot4i.tutorials/dist/css/app.css" />
    	
		<script src="http://ot4i.github.io/ot4i.tutorials/dist/js/json2.js"></script>
		<script src="http://ot4i.github.io/ot4i.tutorials/dist/js/js2java.js"></script>
		<script src="http://ot4i.github.io/ot4i.tutorials/dist/js/js2java_steps.js"></script>
		<script src="http://ot4i.github.io/ot4i.tutorials/dist/js/vendor/modernizr.js"></script>
	</head>
<!-- header::End -->
<!-- body::Start -->
		<body>
  	<!-- body content here -->
	<div class="row">
	  <div class="small-12 medium-12 large-12 columns">
	    <p> </p>
	  </div>
	</div>
	<div class="row">
	  <div class="small-9 medium-9 large-9 columns">
	    <h4>Modeling COBOL data by using DFDL</h4>
	  </div>
	  <div class="small-3 medium-3 large-3 columns">
		<a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.msgbroker.helphome.doc/help_home_msgbroker.htm')" class="small right helplink">IBM Knowledge Center</a> 
	  </div>
	</div> 
	<hr>
	<div class="row">
		<div class="small-10 medium-10 large-10 columns">
		<h5> Learn how to model COBOL data by using Data Format Description Language (DFDL). </h5>
		</div>
		<div class="small-2 medium-2 large-2 columns">
			<div class="small radius button right" id="backToGallery" onclick="backToGallery()"> Back To Gallery
			</div>
		</div>
	</div>
	<div class="row">          
		  <div class="small-12 medium-12 large-12 columns">
			<ul class="tabs vertical"> 
				<li class="tab-title tab-title-small active"> 
				  <a href="javascript:;" onclick="show('panel11')">Overview</a>
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel21')">Create</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel31')">Prepare</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel41')">Run</a> 
				</li>
			</ul>
			<!-- editing -->
			<div class="tabs-content panel-thin-blue vertical"> 
			    <div class="content active" id="panel11">
			    	<div class="small-12 medium-12 large-12 columns">
				    	<div class="row content-details">
					      	<h4>Overview</h4>
					        
						    
								<p> COBOL is a programming language most commonly used on mainframe computers. In-memory COBOL data structures are defined either in COBOL programs or COBOL copybooks. These data structures are commonly written to files or message queues. </p>
							
								<p> COBOL data structures can contain fields of several different physical types, including character strings (PIC X), zoned decimals (PIC 9), packed decimals (PIC 9 COMP-3) and two's complement integers (PIC 9 COMP). </p>
							
								<p> The DFDL editor provides a COBOL importer which can read COBOL copybooks and programs and generate the equivalent DFDL schema. </p>
							
						</div>
							
						<div class="row content-details">
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bd40430_.htm')" title="Knowledge Center link to Message modeling overview">Message modeling overview</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/df20125_.htm')" title="Knowledge Center link to How to model data with DFDL">How to model data with DFDL</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bd22930_.htm')" title="Knowledge Center link to Working with COBOL data">Working with COBOL data</a> </li>
							   	
							
							</ul>
						</div>	
							
					</div>
				</div>
		    	<div class="content" id="panel21">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				      	<div class="row content-details">
					      	<h4>Import projects and create schema</h4>
					        
						    
								<p> Click <span class="uicontrol">Import and a shared library is imported into your workspace. </span></p>
								
							
								<p> Library <span class="library">COBOL-Purchases</span> contains a COBOL copybook called <span class="filepath">PurchaseData.cpy</span> in 'Other resources'. It defines a COBOL data structure that records the purchases made by a customer. Open the copybook and look at the COBOL structure which is called PurchaseData. The main points of interest are: </p>
								
							
								<p>  </p>
								
								
									
									<ol>
									
									
										<li> OCCURS DEPENDING ON. The purchases are recorded by an array of Item structures. There can be between 1 and 50 occurrences of Item, with the actual number provided by the ItemCount field at the start of the data.
										
										</li>
									
										<li> REDEFINES. Structure ItemGrocery is followed by structure ItemNonGrocery which overlays it. This means that either ItemGrocery or ItemNonGrocery will be present, but not both. The preceding ItemType field indicates which is actually present.
										
										</li>
									
									
									</ol>
									
								
							
								<p> You will now create a DFDL schema to model the COBOL PurchaseData structure, using the <span class="wintitle">New Message Model</span> wizard. </p>
								
							
								<p> <b>Tip:</b> Ensure that steps 1 to 7 below are all visible in the <span class="uicontrol">Tutorial Steps View</span> before proceeding. </p>
								
							
								<p>  </p>
								
								
									
									<ol>
									
									
										<li> With <span class="filepath">PurchaseData.cpy</span> selected, click <span class="uicontrol">New...</span> in the <span class="uicontrol">Application Development</span> view, then select <span class="uicontrol">Message Model...</span>. The <span class="wintitle">New Message Model</span> wizard opens.
										
										</li>
									
										<li> Select <span class="uicontrol">COBOL</span> then click <span class="uicontrol">Next</span>.
										
										</li>
									
										<li> Select the option <span class="uicontrol">Create a DFDL schema file by importing a COBOL copybook or program</span> then click <span class="uicontrol">Next</span>.
										
										</li>
									
										<li> <span class="filepath">PurchaseData.cpy</span> should be highlighted. Click <span class="uicontrol">Next</span>.
										
										</li>
									
										<li> The wizard loads and compiles the copybook, and presents all the 01 level structures it finds. Click the <span class="uicontrol">&gt;&gt;</span> button then click <span class="uicontrol">Next</span>.
										
										</li>
									
										<li> Here you can choose settings for DFDL properties such as default values, null values and padding characters. Leave the options to default and click <span class="uicontrol">Next</span>.
										
										</li>
									
										<li> Here you can choose platform dependent settings such as encoding and zoned decimal sign representation. Leave the options to default and click <span class="uicontrol">Next</span>.
										
										</li>
									
									
									</ol>
									
								
							
								<p> Two DFDL schemas are created in the library. Schema <span class="filepath">PurchaseData.xsd</span> models the overall COBOL data structure. Schema <span class="filepath">CobolDataDefinitionFormat.xsd</span> defines suitable default values for DFDL properties. The imported copybook is copied into the importFile folder and a report is created in the log folder. </p>
								
							
						</div>
						
						<div class="row content-details">
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/df20061_.htm')" title="Knowledge Center link to Working with DFDL schema files">Working with DFDL schema files</a> </li>
							   	
							
							</ul>
						</div>
						
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="importArtifacts(); openResource('MainCopybook')"> Import <img class="icon-image" src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/ibmdesign/back-right-previous_128-orange.png"></a></h4>
										
				    </div>
					
		    	</div>
		    	<div class="content" id="panel31">
					
					<div class="small-12 medium-12 large-12 columns">
					
						<div class="row content-details">
						  	<h4>Exploring the schemas</h4>
						    
						    
								<p> The <span class="library">COBOL-Purchases</span> library is shown in the <span class="uicontrol">Application Development</span> view of your workspace. </p>
								
							
								<p> The <span class="filepath">PurchaseData.xsd</span> DFDL schema opens in the DFDL editor. If it does not open, double-click the DFDL schema to open it in the editor. </p>
								
							
								<p> The PurchaseData message is highlighted and models the COBOL PurchaseData structure from the copybook. The main editor view shows the logical components of the message such as elements and sequences. You can explore the PurchaseData structure by expanding the elements. </p>
								
							
								<p> The physical rendering of each logical component is described by the DFDL properties in the <span class="uicontrol">Representation Properties</span> tab. DFDL properties can be specified locally on the component, or can be inherited from pre-defined sets of DFDL properties. Inherited properties have an icon <img src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/iib/dfdlInheritedProperty.png" alt> shown next to them, and hovering over the icon reveals where the property is defined. In this schema, inherited properties are obtained from schema <span class="filepath">CobolDataDefinitionFormat.xsd</span>. </p>
								
							
								<p> The COBOL REDEFINES within Item has been imported as <span class="varname">xs:choice</span>. The COBOL OCCURS DEPENDING ON has resulted in the DFDL property <span class="varname">Occurs Count Kind</span> for Item being set to 'expression', and the DFDL property <span class="varname">Occurs Count</span> is a DFDL expression that refers to ItemCount. </p>
								
							
								<p> You will be test parsing an example binary data file using the PurchaseData message. The test parsing takes place entirely within the DFDL editor, so there is no message flow in this tutorial and no Deploy step. Before test parsing, switch to the <span class="uicontrol">DFDL Test</span> perspective by clicking <span class="uicontrol">Window &gt; Open Perspective</span> and then clicking <span class="uicontrol">DFDL Test</span>. (Alternatively, you can use the toolbar icon <img src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/iib/changePerspective.png" alt>). </p>
								
							
								<p> <b>Tip:</b> If this <span class="uicontrol">Tutorial Steps View</span> tab disappears when you switch perspectives, use the <span class="uicontrol">Window &gt; Show View</span> menu option to add it back. </p>
								
							
						</div>
						
						<div class="row content-details">
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/df20061_.htm')" title="Knowledge Center link to Working with DFDL schema files">Working with DFDL schema files</a> </li>
							   	
							
							</ul>
						</div>
							
					</div>
					
		    	</div>
		    	<div class="content" id="panel41">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				    	<div class="row content-details">
					      	<h4>Follow these steps to complete the tutorial</h4>
					        
						    
								<p> The <span class="filepath">PurchaseData.xsd</span> DFDL schema is open in the DFDL editor. The PurchaseData message should be highlighted in green. </p>
								
							
								<p>  </p>
								
								
									
									<ol>
									
									
										<li> Test parse an example COBOL file:
										
										
											
											<ol>
											
												
													<li> Click the <span class="uicontrol">Test Parse Model</span> button in the DFDL editor toolbar. The <span class="wintitle">Test Parse Model</span> window opens.</li>
												
													<li> In the Message section, select <span class="uicontrol">PurchaseData</span>.</li>
												
													<li> In the Parser Input section, select <span class="uicontrol">Content from a data file</span> then click <span class="uicontrol">Browse</span>.</li>
												
													<li> Select the <span class="filepath">PurchaseData1.bin</span> file from <span class="library">COBOL-Purchases</span> then click <span class="uicontrol">OK</span>.</li>
												
													<li> Set the Encoding to <span class="uicontrol">ASCII</span>.</li>
												
													<li> Click <span class="uicontrol">OK</span>. If asked to confirm switching to the DFDL Test perspective, click <span class="uicontrol">Yes</span>.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> The results of the test parse are displayed. You should see the message <span class="systemoutput">Parsing completed successfully</span>. You can dismiss this message.
										
										</li>
									
										<li> You can view the parsed data file in the <span class="uicontrol">DFDL Test - Parse</span> view. The results of the parse can be viewed in the <span class="uicontrol">DFDL Test - Logical Instance</span> view, as a tree or as XML. If you expand Invoice and then each Item, you can see that the parser has correctly resolved the <span class="varname">xs:choice</span> to either ItemGrocery or ItemNonGrocery.
										
										</li>
									
										<li> When the parser encounters a <span class="varname">xs:choice</span>, its default strategy is to parse the data by trying the first branch of the choice. If that fails, the parser backtracks and tries the second branch. And so on, until a branch parses successfully. In our example, the parser tries ItemGrocery first, and if that fails it backtracks and tries ItemNonGrocery.
										
										</li>
									
										<li> Open the <span class="uicontrol">DFDL Test - Trace</span> view and scroll back through the trace entries. You will see an error message CTDP3053E saying that a zoned number conversion error occurred. At this point the parser was attempting to parse the choice by trying ItemGrocery, but the error occurred. The trace entries after that show the parser backtracking and attempting to parse the choice by trying ItemNonGrocery, which succeeded.
										
										</li>
									
										<li> Sometimes the default strategy of the parser is not sufficient to resolve a <span class="varname">xs:choice</span> resulting from a COBOL REDEFINES. If that is the case, DFDL provides two other features to help you - discriminators and direct dispatch. These DFDL features are covered in detail by other IBM Integration Bus tutorials.
										
										</li>
									
										<li> Test serialize the logical instance that resulted from the parse:
										
										
											
											<ol>
											
												
													<li> Click the <span class="uicontrol">Test Serialize Model</span> button in the DFDL editor toolbar. The <span class="wintitle">Test Serialize Model</span> window opens.</li>
												
													<li> In the Serializer Input section, select <span class="uicontrol">Content from a DFDL Test - Logical Instance</span>.</li>
												
													<li> Set the Encoding to <span class="uicontrol">ASCII</span>.</li>
												
													<li> Click <span class="uicontrol">OK</span>.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> The results of the test serialize are displayed. You should see the message <span class="systemoutput">Serialization completed successfully</span>. You can dismiss this message.
										
										</li>
									
										<li> You can view the serialized data file in the <span class="uicontrol">DFDL Test - Serialize</span> view. You can view a log of the serializer actions in the <span class="uicontrol">DFDL Test - Trace</span> view.
										
										</li>
									
										<li> As an alternative to the toolbar buttons, you can also test from the <span class="uicontrol">DFDL Test - Parse</span> and <span class="uicontrol">DFDL Test - Serialize</span> views, using the <span class="uicontrol">Browse</span> button to select a data source and the green play icon <img src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/iib/dfdlTestPlay.png" alt> to run the DFDL parser or serializer.
										
										</li>
									
									
									</ol>
									
								
							
								<p> The shared library can be deployed to an integration node for use by message flows. </p>
								
							
						</div>
						
						<div class="row content-details"> 	
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/df20065_.htm')" title="Knowledge Center link to Testing a DFDL schema file">Testing a DFDL schema file</a> </li>
							   	
							
							</ul>
						</div>
							
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="cleanUp()" title="Clean up and remove any changes in your workspace made by the tutorial."> Clean Up <img class="icon-image" src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/ibmdesign/close-cancel-error_128-red.png"></a></h4>
				    
					
				    </div>
					
				</div>	
			</div> <!-- tab-content -->
		</div> <!-- columns -->
	  </div> <!-- row --></body>
		<script src="http://ot4i.github.io/ot4i.tutorials/dist/js/vendor/jquery.js"></script>
		<script src="http://ot4i.github.io/ot4i.tutorials/dist/js/vendor/foundation.min.js"></script>
		<script src="http://ot4i.github.io/ot4i.tutorials/dist/js/main.js"></script>
	</body>
<!-- body::End -->

</html>